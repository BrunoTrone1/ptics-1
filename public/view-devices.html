<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ver Dispositivos</title>
    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Iconos -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <!-- stylesheet -->
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body class="d-flex flex-column min-vh-100">
    <header class="navbar navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="/">
          <h1>SafeDevice</h1>
        </a>
        <nav class="navbar navbar-expand-lg">
          <!-- Links para las demas rutas -->
          <div class="collapse navbar-collapse justify-content-end">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link" href="/register">Registrarse</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/register-device"
                  >Registrar Dispositivo</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/login">Iniciar Sesión</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/logout">Salir</a>
              </li>
            </ul>
          </div>
        </nav>
      </div>
    </header>

    <div class="container container-small flex-grow-1">
      <h1 class="mt-4">Dispositivos Registrados</h1>
      <div class="list-group mt-4" id="device-list">
        <!-- Aquí se añadirán los dispositivos mediante JavaScript -->
      </div>
    </div>

    <div class="footer py-3 text-white mt-auto">
      <div class="container text-center">
        <p>&copy; 2024 SafeDevice. Todos los derechos reservados.</p>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Datos de prueba para los dispositivos
      const devices = [
        { deviceId: "Dispositivo A123", createdAt: "2024-05-01T00:00:00Z" },
        { deviceId: "Dispositivo B456", createdAt: "2024-05-12T00:00:00Z" },
        { deviceId: "Dispositivo C789", createdAt: "2024-05-20T00:00:00Z" },
      ];

      // Función para renderizar los dispositivos en la página
      function renderDevices(deviceList) {
        const listElement = document.getElementById("device-list");
        listElement.innerHTML = "";

        if (deviceList.length === 0) {
          listElement.innerHTML = "<p>No tienes dispositivos registrados.</p>";
        } else {
          deviceList.forEach((device) => {
            const deviceItem = document.createElement("div");
            deviceItem.className = "list-group-item list-group-item-action";
            deviceItem.innerHTML = `
              <h5 class="mb-1">${device.deviceId}</h5>
              <small>Registrado el: ${new Date(
                device.createdAt
              ).toLocaleDateString()}</small>
              <br />
              <button class="btn btn-primary btn-sm mt-2" onclick="viewHistory('${
                device.deviceId
              }')">Ver Historial</button>
            `;
            listElement.appendChild(deviceItem);
          });
        }
      }

      // Función para redirigir a la página de historial
      function viewHistory(deviceId) {
        window.location.href = `/device-history.html?deviceId=${deviceId}`;
      }

      // Llamar a la función para renderizar los dispositivos al cargar la página
      renderDevices(devices);
    </script>
  </body>
</html>
